---
title: "Singapore HDB Resale Flat Prices for 1990 - 2022"
output: 
  github_document:
    toc: TRUE
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, root.dir = "C:/Users/iylia.hutta/OneDrive - Meltwater/Desktop/Data Stuff/Singapore HDB Flat Resale Prices")
```

```{r packages, include = FALSE}
library(tidyverse)
library(readr)
```


## Introduction

As a millenial growing up in Singapore and starting out in my first job, one of my life's goals is to own a house on this little red dot with my life partner (*read: wife*). 

Here in [Singapore](https://en.wikipedia.org/wiki/Singapore), there are generally [two ways](https://www.propertyguru.com.sg/property-guides/the-different-types-of-housing-in-singapore-9916) to do this:

- [Public Housing](https://www.hdb.gov.sg/about-us/our-role/public-housing-a-singapore-icon)
  - Brand new Built-to-Order (BTO) Flats (or apartments)
  - Resale Flats
- Private Housing (e.g., condominiums, landed property, etc.)

Whilst BTOs tend to be the choice of most young Singaporean couples, my current and potential future situation may push my partner and I to look towards resale flats to meet our housing needs. As such, I set forth on this project that will focus on resale flats under the Housing & Development Board (HDB).

This project therefore seeks to analyse the prices of Singapore's HDB Resale Flats for the years of 1990 - 2022. Data was obtained from Kaggle, [(1)](https://www.kaggle.com/datasets/syrahmadi/resale-hdb-flat-prices-2000-2022) and [(2)](https://www.kaggle.com/datasets/chngyuanlongrandy/hdb-prices-with-closest-mrt-distance), which were sourced from GovTech's open data portal, [data.gov.sg](https://data.gov.sg/dataset/resale-flat-prices).

```{r import, message=FALSE, echo = FALSE}
#import data as objects
nineties_data <- read_csv("C:/Users/iylia.hutta/OneDrive - Meltwater/Desktop/Data Stuff/Singapore HDB Flat Resale Prices/Data/resale-flat-prices-based-on-approval-date-1990-1999.csv")
feb2012_data <- read_csv("C:/Users/iylia.hutta/OneDrive - Meltwater/Desktop/Data Stuff/Singapore HDB Flat Resale Prices/Data/resale-flat-prices-based-on-approval-date-2000-feb-2012.csv")
dec2014_data <- read_csv("C:/Users/iylia.hutta/OneDrive - Meltwater/Desktop/Data Stuff/Singapore HDB Flat Resale Prices/Data/resale-flat-prices-based-on-registration-date-from-mar-2012-to-dec-2014.csv")
dec2016_data <- read_csv("C:/Users/iylia.hutta/OneDrive - Meltwater/Desktop/Data Stuff/Singapore HDB Flat Resale Prices/Data/resale-flat-prices-based-on-registration-date-from-jan-2015-to-dec-2016.csv")
latest_data <- read_csv("C:/Users/iylia.hutta/OneDrive - Meltwater/Desktop/Data Stuff/Singapore HDB Flat Resale Prices/Data/resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv")
```


## Data Exploration

First, we will examine the data to understand its structure and contents.

```{r data exploration, echo = FALSE}
head(nineties_data)
head(feb2012_data)
head(dec2014_data)
head(dec2016_data)
head(latest_data)
```

From these, we see that the data structure is generally similar. The only difference being that the "Jan 2015 - Dec 2016" and "Jan 2017 onwards" data consists of an extra column `remaining_lease`, indicating the remaining years of lease for the houses in the datasets. For the purpose of this project then, we will be dropping this column to maintain data uniformity.

```{r drop excess columns, echo = FALSE}
dec2016_data <- dec2016_data %>% 
  select(!remaining_lease)

head(dec2016_data)

latest_data <- latest_data %>% 
  select(!remaining_lease)

head(latest_data)
```

```{r union datasets, echo = FALSE}
resale_data <- bind_rows(nineties_data,feb2012_data,dec2014_data,dec2016_data,latest_data)

head(resale_data)
```

Now that the data is similar, we can combine the datasets together. Looking into the dataset, we see that the `storey_range` variable has varied values, which we will be renaming into a new variable called `storeys`.

However, before we create the new variable, it would be helpful to understand the range of storey ranges among the resale flats and create a new variable to categorise them. 

Even in 2022, very few resale flats have more than 12 to 15 floors, hence, everything above the 9th floor will be tagged as *"high"*.

```{r storey_ranges, warning = FALSE, message = FALSE, echo = FALSE}
#examine the values in storey_range for each year period
resale_data %>% 
  group_by(storey_range) %>% 
  summarise(count = n()) %>% 
  ggplot(aes(x = storey_range, y = count)) +
  geom_col() +
  coord_flip() +
  labs(y = "Count of flats",
       x = "Storey Ranges",
       title = "Number of flats per storey range in 1990 to 2022")

#create new variable 
resale_data <- resale_data %>% 
  mutate(storeys = factor(case_when(
    storey_range == "01 TO 03" | storey_range == "01 TO 05" | storey_range == "04 TO 06" ~ "low",
    storey_range == "06 TO 10" | storey_range == "07 TO 09" ~ "mid",
    TRUE ~ "high"
  ),
  levels = c("low", "mid", "high"))) %>% 
  relocate(storeys, .after = storey_range)

head(resale_data)
```

## Exploratory Data Analysis

Now that the data is cleaned and ready for analysis, we can do some quick exploratory analyses.

First, we know that generally, HDB flat prices tend to vary by their storey levels. We can visualise this layman assumption here:

```{r plot storeys and price, echo = FALSE}
ggplot(resale_data, aes(x = storeys, y = resale_price/1000)) +
  geom_boxplot() +
  coord_flip() +
  labs(x = "Storeys",
       y = "Prices (thousands; SGD)",
       title = "Spread of HDB Resale Flat Prices by Storey levels") +
  scale_y_continuous(breaks = seq(0, 1500, by = 200))
```

Although the variation and range of resale flat prices are relatively the same, the median prices for each of the storey categories seem to fit this assumption. That is, HDB flats on the lower levels generally tend to cost less than those on the higher levels.

One possible explanation for near similar variations and ranges could be the scope of the dataset, which covers approximately 30 years' worth of data. Furthermore, the above chart does not take into account the HDB town, which, as most Singaporeans know, also influences the prices of flats.

Let's examine the relationship between HDB towns and prices next:

```{r plot towns and price, echo = FALSE}
ggplot(resale_data, aes(x = reorder(town, resale_price, median), y = resale_price/1000)) +
  geom_boxplot() +
  coord_flip() +
  labs(x = "Towns",
       y = "Prices (thousands; SGD)",
       title = "Spread of HDB Resale Flat Prices by HDB towns") +
  scale_y_continuous(breaks = seq(0, 1500, by = 200))
```

It is therefore evident that HDB resale flat prices do vary by their towns. 

